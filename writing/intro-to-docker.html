 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../writing/writing.css">
  <title>Josh Peters - Intro to Docker</title>
  <script src="https://kit.fontawesome.com/77b1d2e451.js" crossorigin="anonymous"></script>
  <script defer src="../components/aside.js"></script>
  <script defer src="../components/footer.js"></script>
  <style>
     pre {
      color: #FDFDFF;
      padding: 1rem;
      border-radius: 8px;
      font-family: monospace;
      white-space: pre-wrap;
    }
    .highlight {
      color: #86D4DE;
      font-weight: bold;
    }
    .highlight.comment {
      color: #C6C5B9;
      font-style: italic;
    }
    .bash-code {
      color: #c5c8c6;
    }
    code {
      background-color: #2C2F31;
      padding: .25rem;
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <div class="body-container">
    <my-aside></my-aside>
    <main>
      <h1 class="desktop-header">JOSH PETERS</h1>
      <div class="content-container">
        <h2 class="article-title">Docker Container from Scratch</h2>
        <sub class="article-date">September 8, 2025</sub>
        <div class="text-body">

          <p><b>Introduction</b><br>I've relied on Docker for many projects, but I've always wondered what's happening behind the scenes. Today, I'm digging into how containers are built and how they really work under the hood. To deepen my understanding of Docker, I will build a container from scratch using Go.</p>

          <p style="margin-top: 3rem;"><b>Namespaces</b><br>Namespaces are a Linus kernel feature that control what a process can "see" and interact with. They created isolated views of system resources so that process inside a container only see their own limited world, not the entire host machine. For example, with the UTS namespace, a container can have its own hostname, independent of the host. With the PID namespace, processes inside the container only see their own process IDs, starting from 1.</p>

          <p>Namespaces are created using system calls (like <code>clone</code>, <code>unshare</code>, and <code>setns</code>). They are a fundamental building block of containers because they provide the illusion that each container is running on its own independent machine, even though all containers share the same underlying kernel.</p>

          <p style="margin-top: 3rem;"><b>Coding Namespaces</b><br>Rather than starting our Docker image by typing the normal command (<code>docker run image &lt;cmd&gt; &lt;params&gt;</code>) we will start our container by running our <code>main.go</code> file (<code>go run main.go run &lt;cmd&gt; &lt;params&gt;</code>). Let's start by writing our <code>main</code> function:</p>

          <pre class="go-code">
func main() {
  switch os.Args[1] {
    case "run":
      run()

    default:
      panic("bad command")
  }
}
          </pre>

          <p>Hopefully, the above code is easy to understand. We simply created a switch statement that will execute the <code>run()</code> function when "run" is passed as the first argument otherwise it <code>panic</code> and terminate the program. Let's implement the <code>run()</code> function that is called:</p>

          <pre class="go-code">
func run() {
  fmt.Printf("Running %v\n", os.Args[2:])

  cmd := exec.Command(os.Args[2], os.Args[3:]...)
  cmd.Run()
}
          </pre>
        </div>
      <my-footer>
        <i class="fa-solid fa-envelope" slot="email-logo"></i>
        <i class="fa-brands fa-github" slot="github-logo"></i> 
        <i class="fa-brands fa-linkedin" slot="linkedin-logo"></i>
      </my-footer>
    </main>
  </div>

  <script type="module">
    import { applyHighlights } from "../scripts/code-highlights.js";

    document.addEventListener("DOMContentLoaded", applyHighlights);
  </script>
</body>
</html>
